<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <title>Atividade 11</title>
</head>
<body>

    <div class="container">
      <h2>Painel Centro Cirurgico</h2>
      <div class="row">
          <input type="hidden" id="id" >
            <div class="form-group col-sm-6"> 
                <label for="nome">Nome do Paciente</label>
                <input type="text" class="form-control" id="nome" name="nome">
            </div>
            <div class="form-group col-sm-3"> 
                <label for="status">Status:</label>
                <select class="form-control" id="status" name="status">
                    <option value="operatorio">Pré Operatório</option>
                    <option value="sala-cirurgica">Em sala de cirugia</option>
                    <option value="recuperacao">Sala de Recuperação</option>
                    <option value="transferido">Transferido</option>
                </select>
            </div>
            <div class="form-group col-md-3">
                <label for ="local">Local:</label>
                <input type="text" class="form-control" id="local" name="local" placeholder="Sala/Quarto">
            </div>
      </div>
      <div class="row">
        <div class="form-group col-md-3">
            <label for="hora-inicio">Hora Início:</label>
            <input type="time" class="form-control" id="horaInicio" name="hora-inicio">
        </div>
        <div class="form-group col-md-3">
            <label for="inicio-previsto">Início Previsto:</label>
            <input type="time" class="form-control" id="inicio-previsto" name="inicio-previsto">
        </div>
        <div class="form-group col-md-3">
            <label for="fim-previsto">Fim Previsto:</label>
            <input type="time" class="form-control" id="fim-previsto" name="fim-previsto">
        </div>
        <div class="form-group col-md-3">
            <label for="saida-prevista">Saída Prevista:</label>
            <input type="time" class="form-control" id="saida-prevista" name="saida-prevista">
        </div>
    </div>
     
    <br>
    <button class="btn btn-secondary" onclick="novo()">Novo</button>
    <button class="btn btn-primary" onclick="salvar()">Salvar</button>
    <button class="btn btn-danger" onclick="excluir()">Excluir</button>

    <table class="table table-hover">
        <thead>
            <tr>
                <th width="40%">Nome do Paciente</th>
                <th width="30%">Status</th>
                <th width="10%">Início Previsto</th>
                <th width="10%">Início da Cirurgia</th>
                <th width="10%">Fim da Cirurgia</th>
                <th width="10%">Saída Prevista</th>
            </tr>
        </thead> 
        <tbody id="tbCorpo">

        </tbody>
    </table>
  </div>

  <script>
      let listaPaciente = [];

      if (localStorage.getItem('listaPaciente') != null) {
          listaPaciente = JSON.parse(localStorage.getItem('listaPaciente'));
      }

      // localStorage.setItem();
      
      function salvar(){
          let paciente = {};
          paciente.nome = document.getElementById('nome').value;

          let i = document.getElementById('id').value;
          console.log(i == '');
          if(i == ''){
            listaPaciente.push(paciente); // console.log(listaPaciente);
          }else{
              listaPaciente[i] = paciente;
          } 
          localStorage.setItem('listaPaciente',JSON.stringify(listaPaciente));
          carregarTable();
          novo();
      }

      function carregarTable(){
        let tabela = `<tr><td>Fabricio Araujo da Silva</td></tr>`;
        for (i in listaPaciente){
        
            tabela += `<tr onclick='editar(${i})'><td>${listaPaciente[i].nome}</td></tr>`;
        }
        document.getElementById('tbCorpo').innerHTML = tabela;
      }

      function editar(i){
          document.getElementById('id').value = i;
          document.getElementById('nome').value = listaPaciente[i].nome;
      }

      function novo(){
          document.getElementById('id').value = '';
          document.getElementById('nome').value = '';
      }

      function excluir(){
          let i = document.getElementById('id').value;
          listaPaciente.splice(i,1);
          localStorage.setItem('listaPaciente', JSON.stringify(listaPaciente));
          carregarTable();
          novo();
      }

      carregarTable();
  </script>
    
</body>
</html>